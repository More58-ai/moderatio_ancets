<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FART UA | Recruitment</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --ua-blue: #0057b7; --ua-yellow: #ffd700; --bg: #010811; --card: rgba(13, 25, 42, 0.98); }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Montserrat', sans-serif; background: var(--bg); color: white; padding: 40px 15px; overflow-x: hidden; }
        #snow-canvas { position: fixed; top: 0; left: 0; pointer-events: none; z-index: 1; }
        
        .main-container {
            max-width: 950px; margin: 0 auto; background: var(--card); border-radius: 40px;
            border: 1px solid rgba(255, 255, 255, 0.08); position: relative; z-index: 10;
            box-shadow: 0 20px 80px rgba(0, 0, 0, 0.8); overflow: hidden;
        }

        .header { 
            background: linear-gradient(135deg, var(--ua-blue), #001f44); padding: 60px 40px; 
            text-align: center; border-bottom: 6px solid var(--ua-yellow);
        }
        .header h1 { font-size: 3.5rem; font-weight: 900; letter-spacing: 8px; text-transform: uppercase; margin-bottom: 10px; }
        .header p { font-size: 1.1rem; opacity: 0.8; font-weight: 600; letter-spacing: 2px; }

        .form-content { padding: 50px; }
        .section-label { 
            display: flex; align-items: center; gap: 15px; color: var(--ua-yellow); 
            font-size: 1.3rem; font-weight: 800; margin: 40px 0 25px; text-transform: uppercase;
        }
        .section-label::after { content: ""; height: 2px; flex: 1; background: rgba(255, 215, 0, 0.2); }

        .grid-layout { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
        @media (max-width: 768px) { .grid-layout { grid-template-columns: 1fr; } }

        .input-group { margin-bottom: 20px; }
        label { display: block; font-size: 0.85rem; font-weight: 700; margin-bottom: 10px; color: rgba(255,255,255,0.6); }
        
        .input-field {
            width: 100%; background: rgba(255, 255, 255, 0.03); border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px; padding: 18px; color: white; font-family: inherit; font-size: 1rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .input-field:focus {
            outline: none; border-color: var(--ua-blue); background: rgba(255, 255, 255, 0.07);
            box-shadow: 0 0 25px rgba(0, 87, 183, 0.3); transform: translateY(-2px);
        }

        .submit-btn {
            width: 100%; padding: 25px; background: linear-gradient(90deg, #ffdd00, #ffb300);
            border: none; border-radius: 20px; font-size: 1.4rem; font-weight: 900; color: #001a33;
            cursor: pointer; margin-top: 50px; transition: 0.4s; text-transform: uppercase;
            box-shadow: 0 15px 40px rgba(255, 215, 0, 0.2);
        }
        .submit-btn:hover:not(:disabled) { transform: scale(1.02); filter: brightness(1.1); box-shadow: 0 20px 50px rgba(255, 215, 0, 0.3); }
        .submit-btn:disabled { opacity: 0.5; cursor: not-allowed; filter: grayscale(1); }

        #timer { color: #ff4d4d; text-align: center; margin-top: 20px; font-weight: 700; display: none; }
        .success-page { display: none; text-align: center; padding: 100px 40px; }
        .success-page i { font-size: 6rem; color: var(--ua-yellow); margin-bottom: 30px; }
    </style>
</head>
<body>

<canvas id="snow-canvas"></canvas>

<div class="main-container">
    <div class="header">
        <h1>FART UA</h1>
        <p>RECRUITMENT PROTOCOL v2.1</p>
    </div>

    <div class="form-content">
        <form id="superForm">
            <div class="section-label"><i class="fas fa-id-card"></i> Identity</div>
            <div class="grid-layout">
                <div class="input-group"><label>Прізвище та Ім'я</label><input type="text" id="name" class="input-field" placeholder="Прізвище Ім'я" required></div>
                <div class="input-group"><label>Місце проживання (Місто)</label><input type="text" id="city" class="input-field" placeholder="Київ" required></div>
                <div class="input-group"><label>Telegram (@nick)</label><input type="text" id="tg" class="input-field" placeholder="@username" required></div>
                <div class="input-group"><label>Discord (Username)</label><input type="text" id="ds" class="input-field" placeholder="nick_ds" required></div>
            </div>

            <div class="section-label"><i class="fas fa-medal"></i> Experience</div>
            <div class="input-group">
                <label>Детально опишіть ваш досвід (проєкти, ролі, причини виходу)</label>
                <textarea id="exp" class="input-field" rows="4" required></textarea>
            </div>
            <div class="input-group">
                <label>Скільки часу ви готові проводити в Discord (щодня)?</label>
                <input type="text" id="hours" class="input-field" placeholder="напр. 5-7 годин" required>
            </div>

            <div class="section-label"><i class="fas fa-microchip"></i> Moderation Test</div>
            <div class="input-group"><label>Ваші перші 3 дії при рейді сервера?</label><textarea id="q1" class="input-field" rows="2" required></textarea></div>
            <div class="input-group"><label>Як ви діятимете, якщо правила порушує ваш друг/адмін?</label><textarea id="q2" class="input-field" rows="2" required></textarea></div>
            <div class="input-group"><label>Якщо учасник "душить" новачків не порушуючи правил прямо?</label><textarea id="q3" class="input-field" rows="2" required></textarea></div>

            <div class="section-label"><i class="fas fa-brain"></i> Psychology</div>
            <div class="input-group">
                <label>Що для вас є неприпустимим у поведінці модератора?</label>
                <textarea id="psy" class="input-field" rows="2" required></textarea>
            </div>

            <button type="submit" id="btn" class="submit-btn">Відправити анкету</button>
            <p id="timer"></p>
        </form>

        <div id="success" class="success-page animate__animated animate__fadeIn">
            <i class="fas fa-crown"></i>
            <h2>АНКЕТУ ВІДПРАВЛЕНО!</h2>
            <p style="margin-top:15px; opacity:0.7">Тепер ви в системі. Очікуйте вердикту від ст. адміністрації.</p>
        </div>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, set, get } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = {
        apiKey: "ВАШ_API",
        authDomain: "uz-tickets-2dcb8.firebaseapp.com",
        databaseURL: "https://uz-tickets-2dcb8-default-rtdb.firebaseio.com",
        projectId: "uz-tickets-2dcb8",
        storageBucket: "uz-tickets-2dcb8.appspot.com",
        messagingSenderId: "SENDER_ID",
        appId: "APP_ID"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const form = document.getElementById('superForm');
    const btn = document.getElementById('btn');
    const timerText = document.getElementById('timer');

    async function checkLimit() {
        const last = localStorage.getItem('fart_ua_submit');
        if (last) {
            const diff = (Date.now() - last) / (1000 * 60 * 60);
            if (diff < 5) {
                btn.disabled = true;
                timerText.style.display = 'block';
                timerText.innerText = `Доступ обмежено! Залишилось: ${Math.ceil(5 - diff)} год.`;
                return true;
            }
        }
        return false;
    }

    checkLimit();

    form.onsubmit = async (e) => {
        e.preventDefault();
        if (await checkLimit()) return;

        btn.disabled = true;
        btn.innerText = "СИНХРОНІЗАЦІЯ...";

        try {
            const ipFetch = await fetch('https://api.ipify.org?format=json');
            const { ip } = await ipFetch.json();
            const safeIP = ip.replace(/\./g, '_');

            const now = new Date();
            const dateStr = now.toISOString().split('T')[0];
            const dsName = document.getElementById('ds').value.trim().replace(/[.#$[\]/]/g, "_");
            const entryID = Date.now().toString().slice(-6);

            // SUPER NORMALIZED STRUCTURE
            const finalData = {
                Identity: {
                    fullName: document.getElementById('name').value,
                    residence: document.getElementById('city').value
                },
                Contacts: {
                    discord: document.getElementById('ds').value,
                    telegram: document.getElementById('tg').value,
                    userIP: ip
                },
                Experience: {
                    history: document.getElementById('exp').value,
                    timeCommitment: document.getElementById('hours').value
                },
                ModerationTest: {
                    raidResponse: document.getElementById('q1').value,
                    conflictManagement: document.getElementById('q2').value,
                    toxicBehaviorLogic: document.getElementById('q3').value
                },
                Psychology: {
                    unacceptableActions: document.getElementById('psy').value
                },
                SystemInfo: {
                    submittedAt: now.toLocaleString('uk-UA'),
                    status: "NEW",
                    applicationID: `FART-${entryID}`
                }
            };

            await set(ref(db, `applications/moderators/${dateStr}/${dsName}_${entryID}`), finalData);
            await set(ref(db, `security/ip_locks/${safeIP}`), { lastSubmit: Date.now() });
            
            localStorage.setItem('fart_ua_submit', Date.now());
            form.style.display = "none";
            document.getElementById('success').style.display = "block";

        } catch (err) {
            alert("Помилка бази! Зв'яжіться з адміном.");
            btn.disabled = false;
        }
    };
</script>

<script>
    const canvas = document.getElementById('snow-canvas');
    const ctx = canvas.getContext('2d');
    let w, h, particles = [];
    function init() {
        w = window.innerWidth; h = window.innerHeight;
        canvas.width = w; canvas.height = h;
        particles = Array.from({length: 60}, () => ({x: Math.random()*w, y: Math.random()*h, r: Math.random()*3+1, s: Math.random()*1+0.5}));
    }
    function draw() {
        ctx.clearRect(0,0,w,h); ctx.fillStyle = "rgba(255,255,255,0.6)"; ctx.beginPath();
        particles.forEach(p => { ctx.moveTo(p.x, p.y); ctx.arc(p.x, p.y, p.r, 0, Math.PI*2); });
        ctx.fill();
        particles.forEach(p => { p.y += p.s; p.x += Math.sin(p.y/40)*0.5; if(p.y > h) p.y = -5; });
        requestAnimationFrame(draw);
    }
    init(); draw(); window.onresize = init;
</script>

</body>
</html>
